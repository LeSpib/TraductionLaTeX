% +----------------------------------------------------+
% | Compilez ce fichier pour obtenir la documentation. |
% +----------------------------------------------------+
%
% Copyright (c) 1998-2011 de Javier Bezos.
% Tous droits réservés. 
%
% Ce fichier est une partie de la distribution de titlesec en version 2.10.0
% --------------------------------------------------------------------------
%
% Il peut être distribué et/ou modifié sous les conditions définies par la
% LaTeX Project Public License, soit en version 1.3, soit (à votre choix) en
% toute version ultérieure.
% La dernière version de cette license est à l'adresse :
%   http://www.latex-project.org/lppl.txt
% et la version 1.3 et les suivantes se retrouve dans toutes les distributions
% de LaTeX dès la version 2003/12/01.
% 
% Ce travail a le statut LPPL de maintenance "maintenu".
% 
% L'actuel mainteneur est Javier Bezos.


\def\fileversion{2.10.0}
\def\docdate{2011-12-15}

\documentclass[a4paper]{ltxguide}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[sf,bf,compact,topmarks,calcwidth,pagestyles]{titlesec}
\usepackage[french]{babel}
% Bloc pour traduction
\usepackage{color}
\usepackage{pifont}
\definecolor{orange5}{RGB}{255,153,0} 
\newcommand{\trad}[1]{\textbf{\textcolor{orange5}{\noindent\ding{54} #1 \ding{54}}}}
\newcommand{\tradini}{\color{orange5}\ding{54}}
\newcommand{\tradfin}{\ding{54}\color{black}}
% Fin du bloc qui doit être retiré une fois le travail achevé
\usepackage{titletoc}
\def\gobble#1{}
\def\cs#1{\expandafter\gobble\string\\#1}
\makeatletter
\newenvironment{desc}
  {\if@nobreak
     \vskip-\lastskip
     \vspace*{-2.5ex}%
   \fi
   \decl}
  {\enddecl}
\makeatother

\usepackage{textcomp,pslatex}
\usepackage[linktocpage]{hyperref}

\title{Les extensions \textsf{titlesec}, \textsf{titleps} et \textsf{titletoc} 
\footnote{L'extension \textsf{titlesec} est actuellement en version 2.10.0.  
\copyright{} 1998--2011 Javier Bezos. L'extension \textsf{titletoc} est actuellement 
en version 1.6. L'extension \textsf{titleps} est actuellement en version 1.1.0  
\copyright{} 1999--2011 Javier Bezos. Tous droits réservés.}}

\author{Javier Bezos\footnote{Pour des rapports d'erreur, commentaires et 
suggestions, allez à \href{http://www.tex-tipografia.com/contact.html}%
{\texttt{http://www.tex-tipografia.com/contact.html}}.  L'anglais n'étant pas mon 
point fort, contactez-moi lorsque vous trouvez des erreurs dans ce manuel.  
D'autres extensions du même auteur : \textsf{gloss} (avec
Jos\'e Luis D\'{\i}az), \textsf{enumitem, accents, tensind, esindex,
dotlessi, babeltools}.}}

\date{\docdate}

\widenhead{2.1pc}{0pc}
\titlelabel{\thetitle.\quad}

\renewpagestyle{plain}[\small\sffamily\slshape]{
  \footrule
  \setfoot{}{\usepage}{}}

\newpagestyle{myps}[\small\sffamily\slshape]{
  \headrule
  \sethead{Titlesec}{\sectiontitle}{\usepage}}
  
\pagestyle{myps}

\newcommand{\examplesep}{%
  \begin{center}%
    \rule{4pt}{4pt}%
  \end{center}}

\contentsmargin{0pt}
\titlecontents{section}[1.8pc]
  {\addvspace{3pt}\bfseries}
  {\contentslabel[\thecontentslabel.]{1.8pc}}
  {}
  {\quad\thecontentspage}

\titlecontents*{subsection}[1.8pc]
  {\small}
  {\thecontentslabel. }
  {}
  {, \thecontentspage}
  [.---][.]

\addtolength{\topmargin}{-3pc}
\addtolength{\textwidth}{6pc}
\addtolength{\oddsidemargin}{-2pc}
\addtolength{\textheight}{7pc}

\raggedright
\parindent1em
\parskip0pt

\begin{document}

\maketitle
\tableofcontents
\section{Introduction}
%~~~~~~~~~~~~~~~~~~~~~

Cette extension est pour l'essentiel un remplacement --- partiel ou total --- des 
commandes \LaTeX{} liées au sectionnement, traitant ainsi les titres, en-têtes et 
tables des matières. Elle cherche à apporter de nouvelles fonctionnalités avancées à
 \LaTeX{} : si vous souhaitez juste une interface plus accessible 
que celle du \LaTeX{} classique sans changer la façon dont \LaTeX{} travaille, 
vous pouvez recourir à \textsf{fancyhdr} de Piet van Oostrum, \textsf{sectsty} de 
Rowland McDonnell et \textsf{tocloft} de Peter Wilson, avec lesquels vous pouvez 
faire de belles choses\footnote{Dans la mesure où les commandes de sectionnement 
sont réécrites, leur comportement peut être quelque peu différent dans certains 
cas.}.

Entre autres nouvelles fonctionnalités se trouvent :
\begin{itemize}
\item différentes classes et \og formes\fg{} de titres, avec des outils autorisant une 
grande variété de formats. Vous pouvez définir des formats différents pour les pages 
de gauche et de droite, des titres numérotés ou pas. Vous pouvez aussi mesurer la largeur 
d'un titre, ajouter de nouveaux niveaux de sectionnement, utiliser des graphiques et bien 
plus encore. L'Annexe montre un bon nombre d'exemples : allez-y tout de suite !

\item des en-têtes et pieds de pages définis sans utilisation des commandes de marque
(type |\...mark|), contenant au besoin des marques de haut de page, de première valeur 
\emph{et} de bas de page. Des marques de haut de page correctement synchronisées avec les 
titres, sans incompatibilité avec la mécanique des flottants. Des éléments 
décoratifs ajoutés aisément, incluant des environnements d'image.

\item de jolies tables des matières de forme libre, avec la possibilité de grouper les 
entrées de différents niveaux en un paragraphe ou de changer les formats des entrées 
au milieu d'un document. 
\end{itemize}
\textsf{Titlesec} fonctionne avec les classes standards et de nombreuses autres, 
telles celles de l'AMS, et interagit sans aucune difficulté avec 
\textsf{hyperref}\footnote{Cependant, notez bien que les classes AMS réimplémentent  
les commandes internes d'origine. Ces changements seront perdus ici. La 
compatibilité avec \textsf{hyperref} a été testée avec \textsf{dvips}, 
\textsf{dvipdfm} et \textsf{pdftex} mais il s'agit d'une fonctionnalité non 
suivie. Pensez à vérifier que votre version d'\textsf{hyperref} est compatible 
avec \textsf{titlesec}.}. Malheureusement, elle n'est pas compatible avec 
\textsf{memoir}, ce dernier proposant ses propres outils avec un sous-ensemble limité 
des fonctionnalités disponibles dans \textsf{titlesec}.

Comme d'habitude, chargez l'extension de façon classique avec |\usepackage|. 
Redéfinissez alors les commandes de sectionnement soit avec les paramétrages simples 
prédéfinis (voir section \og Interface simplifiée \fg{}), soit avec les commandes 
mises à disposition si vous souhaitez des formats plus élaborés (voir section 
\og Interface avancée \fg{}). Dans ce dernier cas, vous avez uniquement besoin de 
redéfinir les commandes que vous utiliserez. Les deux méthodes sont disponibles 
au même moment mais, |\part| étant souvent implémentée de façon non standard, elle 
reste inchangée par les paramétrages prédéfinis et doit être modifiée avec l'aide 
de l'\og Interface avancée \fg{}.


\section{Interface simplifiée}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

La façon la plus simple de changer le format se fait avec un ensemble d'options 
d'extension et par deux commandes. Si les fonctionnalités apportées par cet ensemble 
d'outils vous donne satisfaction, vous n'avez pas besoin d'aller plus loin dans ce 
manuel. Lisez uniquement cette section et ignorez les suivantes. 

\subsection{Format}
%~~~~~~~~~~~~~~~~~~

Il y a trois groupes d'options contrôlant les fontes, tailles et alignements. 
Vous n'avez pas besoin de définir tous ces groupes puisque des valeurs par défaut 
sont disponibles pour chacun; cependant, vous devez au moins utiliser une option 
parmi celles possibles si vous souhaitez utiliser ce \og paramétrage simplifié 
\fg{}.

\begin{desc}
|rm sf tt md bf up it sl sc|
\end{desc}
Cette option sélectionne la famille/série/forme correspondante. La valeur par 
défaut est |bf|.

\begin{desc}
|big medium small tiny|
\end{desc}
Cette option sélectionne la taille des titres. Elle est fixée par défaut à |big|, 
ce qui donne la taille retenue dans les classes standards. Avec |tiny|, les 
niveaux de sectionnements (chapitres exceptés) sont composées à la même taille 
que le texte. |medium| et |small| sont des présentations intermédiaires entre 
les deux premières.

\begin{desc}
|raggedleft center raggedright|
\end{desc}

Cette option contrôle l'alignement, chaque valeur permettant respectivement 
alignement à droite\footnote{Le terme anglais est à rapprocher du terme 
typographique français \og drapeau gauche \fg{}.}, le centrage et l'alignement 
à gauche.

\subsection{Espacement}
%~~~~~~~~~~~~~~~~~~~~~~

\begin{desc}
|compact|
\end{desc}
Cette option est indépendante de celles vues ci-dessus et réduit l'espace au-dessus 
et au-dessous des titres. 

\subsection{Majuscules}
%~~~~~~~~~~~~~~~~~~~~~~

\begin{desc}
|uppercase|
\end{desc}

\fbox{2.9} Cette option met en majuscules des titres. Selon la classe, cela peut
ne pas marcher avec \verb|\chapter| et \verb|\part|.

\subsection{Outils}
%~~~~~~~~~~~~~~~~~~

\begin{desc}
|\titlelabel{<format-de-numérotation>}|
\end{desc}
Cette option change le format de la numérotation des sections, sous-sections, etc. 
Une commande générique |\thetitle| est fournie et correspond respectivement à 
|\thesection|, |\thesubsection|, etc. La valeur par défaut des classes standards 
est :
\begin{verbatim}
\titlelabel{\thetitle\quad}
\end{verbatim}
Vous pouvez ajouter un point après la numérotation avec :
\begin{verbatim}
\titlelabel{\thetitle.\quad}
\end{verbatim}
Ceci a été fait dans ce document.

\begin{desc}
|\titleformat*{<commande>}{<format>}|
\end{desc}

Cette commande permet de changer le |<format>| d'une commande de sectionnement, comme
par exemple :
\begin{verbatim}
\titleformat*{\section}{\itshape}
\titleformat*{\subsection}{\raggedleft\bfseries}
\end{verbatim}

\section{Interface avancée}
%~~~~~~~~~~~~~~~~~~~~~~~~~~

Deux commandes sont mises à disposition pour changer le format des titres. La première
est utilisée pour le format \og interne \fg{}, autrement dit la forme, la fonte, 
la numérotation, etc. La seconde définit le format \og externe \fg{}, autrement dit 
l'espacement avant et après, l'indentation, etc. Ce principe est pensé pour simplifier 
les définitions car, dans la plupart des cas, vous souhaiterez modifier soit 
l'espacement, soit le format\footnote{L'information est \og extraite \fg{} des 
commandes de sectionnement de la classe, excepté pour les chapitres et parties. Les
définitions sont supposées utiliser |\cs{@startsection}| --- si les sections ont été
définies sans cette commande, des valeurs arbitraires de format sont proposées et 
peuvent être modifiées par la suite. Malheureusement, il n'y a pas de manière de
récupérer les formats des chapitres ou parties ; un format similaire à celui des 
classes standards est alors utilisé.}. Tout ceci redéfinit les commandes de 
sectionnement existantes mais n'en crée par de \emph{nouvelles}. De nouveaux niveaux
de sectionnement peuvent être ajoutés avec |\titleclass|, comme décrit en 
\ref{classes}, et leur format peut être fixé par les commandes décrites ici.

\subsection{Format}
%~~~~~~~~~~~~~~~~~~

Des formes contrôlant la distribution basique des éléments d'un titre
sont proposées. En voici la liste :
\begin{description}
\item[hang] est la valeur par défaut, avec une numérotation en retrait (comme avec 
|\section| dans les classes standards).

\item[block] compose le titre complet en un bloc (un paragraphe) sans mise en forme
additionnelle. Utile pour les titres centrés\footnote{Si le titre fait plus d'une 
ligne de long en utilisant la forme |hang|, la numérotation sera légèrement 
déplacée vers la gauche exception faite des cas avec des |\string\\| 
explicites.} et les mises en forme spéciales (incluant des outils graphiques 
comme |picture|, |pspicture|, etc.).

\item[display] place la numérotation dans un paragraphe séparé (comme avec 
|\chapter| dans les classes standards).

\item[runin] restitue un titre suivi directement du texte sur la même ligne (comme
avec |\paragraph| dans les classes standards).

\item[leftmargin] place le titre dans la marge de gauche. Les titres en bas de page
sont déplacés sur la page suivante et ne restent pas isolés dans la marge du bas, ce 
qui signifie que de longs titres peuvent générer des pages trop peu 
remplies\footnote{Cependant, les flottants placés une ou deux lignes après le 
titre interfèrent avec la découpe de page utilisée ici et le titre peut parfois 
rester placé en bas de page}. Dans ce cas, vous pouvez augmenter l'étirabilité 
des éléments de la page, utiliser |\raggedbottom| ou utiliser l'option d'extension 
|nobottomtitles| décrite ci-après. Dans la mesure où le mécanisme retenu est 
indépendant de celui des paragraphes placés dans les marges, ils peuvent se
superposer. Un synonyme obsolète à cette forme est |margin|.

\item[rightmargin] est similaire à |leftmargin| mais pour la marge de droite.

\item[drop] dispose le texte autour du titre, uniquement si le premier paragraphe
est plus long que le titre (sinon, ils se superposent). Les commentaires associés
à |leftmargin| s'appliquent également ici. 

\item[wrap] est assez proche de |drop|.  La seule différence est que, tandis que
l'espace réservé dans |drop| pour le titre est fixé, il est automatiquement 
ajusté avec |wrap| à la ligne la plus longue. Les limitations de |calcwidth| 
expliquées en \ref{rules} s'appliquent également ici.

\item[frame] Similaire à |display|, mais le titre sera encadré.
\end{description}

Notez bien, cependant, que certaines formes n'ont aucun sens dans le cas des
chapitres et des parties.

\begin{desc}
|\titleformat{<commande>}[<forme>]{<format>}{<num>}{<sep>}{<code-avant>}[<code-après>]|
\end{desc}

Ici,
\begin{itemize}
\item |<commande>| est la commande de sectionnement à redéfinir, autrement dit  
|\part|, |\chapter|, |\section|, |\subsection|, |\subsubsection|, |\paragraph| 
ou |\subparagraph|.

\item La forme du paragraphe est fixée par |<forme>|, dont les valeurs possibles sont
celles décrites ci-dessus.

\item |<format>| est le format appliqué à l'ensemble du titre --- numérotation et 
texte. Cet argument peut contenir des éléments verticaux (et horizontaux avec 
certaines formes) qui sont composés juste après l'espace au-dessus du titre.

\item La numérotation est définie dans |<num>|.  Vous pouvez le laisser vide s'il 
n'y a pas de numérotation de sectionnement à ce niveau, mais cela n'est pas 
recommandé car le nombre n'est pas supprimé dans la table des matières et dans 
les en-têtes de page.
 
\item |<sep>| est la séparation horizontale entre la numérotation et le corps du
titre et doit être une longueur (qui ne doit pas être vide). Cet espace est 
vertical dans la forme |display| ; dans |frame|, il s'agit de la distance entre 
le texte et l'encadrement. |<num>| et |<sep>| sont tous deux ignorés dans les 
versions étoilées des commandes de sectionnement. Si vous utilisez |picture| et 
ses semblables, mettez ce paramètre à 0 pt.

\item |<code-avant>| est un code précédent le corps du titre. La toute dernière 
commande peut prendre un argument, le texte du titre\footnote{Rappelez-vous 
que la taille de la fonte peut être changée de façon sécurisée uniquement entre 
les paragraphes et que les changements dans le texte doivent être faits localement
avec un groupe; Sinon le \trad{leading} pourrait être faux --- trop grand ou trop 
petit.}. Toutefois, avec l'option d'extension \texttt{explicit}, le titre doit
être donné explicitement avec |#1| (voir \ref{others}).

\item |<code-après>| est le code suivant le corps du titre. Le matériel alors 
composé est en mode vertical avec |hang|, |block| et |display| tandis qu'il est 
en mode horizontal avec |runin| et |leftmargin| (\fbox{2.7} avec ce dernier au 
début du paragraphe). Sinon, le code est ignoré.
\end{itemize}

\begin{desc}
|\chaptertitlename|
\end{desc}

Elle renvoie par défaut à |\chaptername| sauf dans le cas des annexes où elle
renvoie vers |\appendixname|. Utilisez-là en lieu et place de |\chaptername| 
lorsque vous définissez un chapitre.

\subsection{Espacement}
%~~~~~~~~~~~~~~~~~~~~~~

\begin{desc}
|\titlespacing*{<commande>}{<gauche>}{<avant-sep>}{<après-sep>}[<droite-sep>]|
\end{desc}

La version étoilée supprime l'indentation du paragraphe suivant le titre, sauf
avec |drop|, |wrap| et |runin| pour lesquels cette possibilité n'a pas de 
sens. 

\begin{itemize}
\item |<gauche>| augmente la marge de gauche, sauf pour les formes |...margin| 
et |drop| où ce paramètre fixe la largeur du titre, pour |wrap|, la largeur 
maximale, et dans |runin| l'indentation juste avant le titre. Avec une 
valeur négative, le titre \trad{overhangs} \footnote{Ce paramètre n'est pas 
équivalent à |<indent>| de |\cs{@startsection}|, qui ne fonctionne pas 
correctement. Avec une valeur négative dans ce dernier et si |<indent>| est
plus grand que la largeur de la numérotation, la première ligne du titre 
commencera dans la marge extérieure, comme attendu, mais les lignes suivantes 
ne le feront pas; pire, les lignes seront raccourcies du côté de la marge 
droite.}.

\item |<avant-sep>| est l'espace vertical avant le titre.

\item |<après-sep>| est la séparation entre le titre et le texte --- verticale 
avec |hang|, |block|, et |display|, horizontale avec |runin|, |drop|, |wrap| 
and |...margin|. En retenant une valeur négative, vous pouvez définir un
espace réel plus petit que |\parskip|\footnote{Voir 
Goossens, Mittelbach and Samarin: \textit{\LaTeX{} Companion}, 
Reading, Addison Wesley, 1993, p.~25.}.

\item Les formes |hang|, |block| et |display| disposent de la possibilité 
d'augmenter la marge |<droite-sep>| avec cet argument optionnel.
\end{itemize}

Si vous n'aimez pas saisir les valeurs complètes des espaces, incluant les
paramètres |plus| et |minus|, une abréviation |*|$n$ est disponible. Dans 
l'argument |<avant-sep>| cette notation équivaut à un espace de $n$ |ex| 
avec une certaine extensibilité et une infime compressibilité. Dans  
|<après-sep>|, l'extensibilité est réduite et il n'y a plus de 
compressibilité\footnote{Ils correspondent à $n$ fois |1ex plus .3ex minus 
.06ex| et |1ex plus .1ex| respectivement.}. Ainsi vous pouvez écrire :
\begin{verbatim}
\titlespacing{\section}{0pt}{*4}{*1.5}
\end{verbatim}
Les longueurs |\beforetitleunit| et |\aftertitleunit| sont utilisées 
comme unités dans les paramètres |*| et vous pouvez les modifier (pour de 
légers changements dans la composition, par exemple).

\textbf{Notes.} |\titlespacing| ne fonctionne pas avec |\chapter| et 
|\part| à moins que vous ne changiez leur format de titre aussi bien par
l'utilisation de |\titleformat|, les paramétrages simples ou |\titleclass|. 
Les arguments de |\titlespacing| doivent être des dimensions;  |\stretch| 
inclut une commande et génère ainsi une erreur.

\subsection{Outils liés à l'espacement}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Ces commandes sont fournies comme outils pour |\titleformat| et |\titlespacing|.

\begin{desc}
|\filright  \filcenter  \filleft  \fillast  \filinner  \filouter|
\end{desc}

Elles consistent en des variantes des commandes |\ragged...|. En particulier,
les commandes |\ragged...| suppriment les espaces à droite et à gauche disposés par
|\titlespacing|\footnote{Rappelez-vous que l'extension \textsf{ragged2e} définit 
quelques commandes additionnelles pour l'alignement comme 
\texttt{\string\justifying}.}. |\fillast| justifie le paragraphe, à l'exception 
de sa dernière ligne qui est centrée. Ces commandes fonctionnent également pour 
la numérotation associée à la forme |frame|.

|\filinner| et |\filouter| correspondent à |\filleft| ou |\filright| selon la page
où elles se trouvent. Du fait du découpage asynchrone des pages par \TeX{}, ces
commandes peuvent être utilisées uniquement dans |\chapter|. Si vous souhaitez un
outil général pour définir différents formats dépendant de la page, voyez 
\ref{extended}.

\begin{desc}
|\wordsep|
\end{desc}

Cette commande donne l'espace inter-mot pour la fonte courante.

\begin{desc}
|indentafter noindentafter| \quad (options d'extension)
\end{desc}

Ces options contournent le réglage du retrait du premier paragraphe pour toutes 
les commandes de sectionnement\footnote{Anciennement nommées |indentfirst| et 
|nonindentfirst|, maintenant obsolètes.}.

\begin{desc}
|rigidchapters rubberchapters| \quad (options d'extension)
\end{desc}

Avec |rigidchapters|, l'espacement pour les titres des chapitres est toujours
le même et |<sep-après>| dans |\titlespacing| ne représente pas l'espace entre 
le bas du texte du titre et le corps du texte comme décrit plus haut mais 
depuis le haut du texte du titre, autrement dit |<sep-avant>| $+$ |<sep-après>| 
est maintenant une distance fixe entre le haut du \trad{corps de page} et le 
texte principal. La valeur par défaut est |rubberchapters| où |<sep-après>| 
désigne la séparation entre le titre et le texte, comme à l'accoutumée. Notez 
que le nom est trompeur : ces options ne s'appliquent pas qu'aux chapitres mais 
à tout titre de classe |top| (les classes sont développées en \ref{classes}).

\begin{desc}
|bottomtitles nobottomtitles nobottomtitles*|  \quad (options d'extension)
\end{desc}

Si |nobottomtitles| est sélectionné, les titres proches de la marge du bas sont
renvoyés en page suivante et la marge sera \trad{ragged}. L'espace minimal requis 
pour que cet effet soit ignoré est fixé (approximativement) par
\begin{verbatim}
\renewcommand{\bottomtitlespace}{<length>}
\end{verbatim}
dont la valeur par défaut est |.2\textheight|. Une simple marge \trad{ragged} sur 
la page précédente est obtenue en mettant une valeur de 0 pt. |bottomtitles| est
l'option par défaut, qui donne à |\bottomtitlespace| une valeur négative.

L'option |nobottomtitles*| propose des calculs plus précis mais les titres de 
forme |margin|, |wrap| ou |drop| peuvent être mal disposés. En temps normal, vous
devriez utiliser la version étoilée.

\begin{desc}
|aftersep largestsep|  \quad (options d'extension)
\end{desc}

Par défaut, lorsqu'il y a deux titres consécutifs, l'espace |<sep-après>| du 
premier titre est utilisé entre les deux titres. Parfois, ce comportement n'est
pas souhaité, en particulier quand l'espace |<sep-avant>| est plus grand que 
|<sep-après>| (sinon le comportement par défaut semble préférable). Avec 
|largestsep|, le plus grand espace est utilisé. La valeur par défaut est |aftersep|.

\begin{desc}
|\\  \\*|\\
|pageatnewline|  \quad (option d'extension)
\end{desc}

\fbox{2.6} Dans les versions 2.6 et suivantes, \verb|\\| ne permet pas de saut de
page et devient un équivalent de \verb|\\*|. Comme personne, \emph{a priori}, ne 
veut un saut de page dans un titre, il s'agit du comportement par défaut. Si, pour
une raison étrange, vous souhaitez autoriser ces sauts de page dans les titres, 
utilisez l'option \verb|pageatnewline|, fournie pour des questions 
de rétrocompatibilité.

\subsection{Filets} \label{rules}
%~~~~~~~~~~~~~~~~~~

L'extension inclut des outils pour aider à l'ajout de filets et autres éléments 
au-dessus comme au-dessous du titre. Les marges des titres pouvant être 
modifiées, ces commandes prennent en compte les paramètres locaux pour placer 
les filets proprement. Elles tiennent également compte de l'espace utilisé dans 
les titres marginaux.

\begin{desc}
|\titleline[<alignement>]{<matériel horizontal>}|\\
|\titlerule[<hauteur>]|\\
|\titlerule*[<largeur>]{<texte>}|
\end{desc}

La commande |\titleline| permet l'insertion d'une ligne, qui peut contenir
du texte et d'autres matériels horizontaux. Elle est pensée 
principalement pour des filets et des points de conduite\footnote{Suite de 
points régulièrement espacés qui se trouvent généralement dans les tables de 
matières.} mais elle peut servir également
pour d'autres besoins. La ligne a une largeur fixée et doit être remplie, 
autrement dit |\titleline{CHAPITRE}| produit une boîte trop peu remplie et donc
mal espacée. Ici le paramètre optionnel |<alignement>| (|l|, |r| ou |c|) peut 
aider en vous permettant de saisir 
|\titleline[c]{CHAPITRE}|\footnote{La valeur par défaut est le paramètre 
\texttt{s} de la commande \texttt{\cs{makebox}}.}.

L'utilisation de |\titleline| à des endroits où un matériel vertical n'est pas
attendu peut conduire à des anomalies. En d'autres termes, vous pouvez l'utiliser
dans les arguments |<format>| (toujours) et |<code-après>|, que ce soit dans les 
formes |hang|, |display| et |block|. Pour la forme |display|, vous pouvez la 
placer au tout début des arguments |<code-avant>| et |<num>|. Mais vous pouvez 
tester cette commande à d'autres endroits : il y a de grandes chances qu'elle 
y fonctionne.

La commande |\titlerule|, qui est incluse automatiquement dans |\titleline| si 
nécessaire, peut être utilisée pour construire des filets et des motifs de 
remplissage. La version non étoilée trace des filets épais de 0.4 pt ou de 
|<hauteur>| si ce dernier est présent. Par exemple,
\begin{verbatim}
\titlerule[.8pt]%
\vspace{1pt}%
\titlerule
\end{verbatim}
trace deux filets de différentes épaisseurs avec une séparation de 1 pt.

La version étoilée fait une variante des points de conduite en remplaçant les
points par le motif répété du |<texte>| placé dans une boîte de sa largeur 
naturelle. Cette largeur de boîte peut être modifiée avec |<largeur>| mais la 
largeur de la première boîte reste inchangée pour que le |<texte>| soit aligné 
avec les bords gauche et droit de l'espace à remplir.
  
Par exemple, avec
\begin{verbatim}
\titleformat{\section}[leftmargin]
  {\titlerule*[1pc]{.}%
   \vspace{1ex}%
   \bfseries}
  {... définitions à la suite
\end{verbatim}
des points de conduite s'étendant au-dessus du texte principal et du titre précèdent 
la section.

\begin{desc}
|calcwidth| \quad (option d'extension)
\end{desc}

La forme |wrap| a la capacité de mesurer les lignes du titre pour mettre en forme le
paragraphe. Cette capacité peut être étendue à trois autres formes --- |display|, 
|block| et |hang| --- avec cette option d'extension. La longueur de la plus longue 
ligne est restituée dans |\titlewidth|\footnote{Il existe deux paramètres plus fins 
|\string\titlewidthfirst| and |\string\titlewidthlast| qui restituent la longueur 
de la première et de la dernière ligne respectivement. Il n'y a pas de fonctions 
dédiées pour s'en servir mais vous pouvez assigner leurs valeurs à 
|\string\titlewidth| et utiliser alors |\string\titleline*|.}.

Du point de vue de \TeX{}, toute boîte est considérée comme du matériel composable.
Si une boîte a été élargie avec de l'espace ou, inversement, si une boîte avec du
texte a été réduite, la valeur de |\titlewidth| peut être fausse (du point de vue
d'un humain). La forme |hang|, par exemple, recourt en interne à de telles boîtes mais, 
dans ce cas, ce comportement est souhaité quand le titre est aligné à droite ; sinon
la forme |block| produit de meilleurs résultats. En d'autres termes, l'utilisation de
boîtes dont la largeur a été manipulée peut être source d'erreurs\footnote{Ce qui
inclut les lignes justifiées dont l'espace inter-mot a été augmenté.}. Pour
être complet, certaines commandes peuvent embrouiller \TeX{} et interrompre l'analyse
du titre. Mais, si vous vous en tenez à du texte, |\\| et |\\[...]| (et il y a peu de 
chances que vous puissiez avoir besoin d'autre chose), vous ne devriez pas rencontrer
de problèmes.

Un autre point important est que les paramètres |<code-avant>|, |<num>|, |<sep>|, et 
|<titre>| (mais pas |<code-après>|) sont évalués deux fois au niveau local; si vous
augmentez un compteur  \emph{globalement}, vous l'augmenterez alors deux fois. Dans
la plupart des cas, placer une \trad{assignation conflictuelle} dans le |<code-après>| 
passera mais vous pouvez également utiliser la commande suivante.

\begin{desc}
|\iftitlemeasuring{<vrai>}{<faux>}|
\end{desc}

\fbox{2.9} Quand le titre est mesuré (première lecture), l'argument |<vrai>| est
traité tandis que, quand le titre est réellement composé (seconde lecture), 
l'argument |<faux>| est traité.

\begin{desc}
|\titleline*[<alignement>]{<matériel horizontal>}|
\end{desc}

Une variante de |\titleline| à utiliser uniquement avec |calcwidth|. Le texte sera
d'abord placé dans une boîte de largeur |\titlewidth|; cette boîte sera à son tour
placée dans la boîte principale avec l'alignement indiqué. Il n'y a pas 
d'équivalent à |\titlerule| et ceci explique pourquoi vous devez le placer 
explicitement dans un |\titleline*| si vous voulez que |\titlewidth| soit pris en 
compte :
\begin{verbatim}
\titleline*[c]{\titlerule[.8pc]}
\end{verbatim}

\subsection{Styles de page}
%~~~~~~~~~~~~~~~~~~~~~~~~~~

\fbox{2.8} Vous pouvez assigner un style de page à des niveaux ayant la classe |top| 
ou |page| (voir \ref{classes}, page \pageref{classes}), aussi bien qu'au chapitre de 
base avec la commande suivante\footnote{Nommée dans l'éphémère version 2.7 
\texttt{\string\titlepagestyle}.} :
\begin{desc}
|\assignpagestyle{<commande>}{<style de page>}|
\end{desc}
Par exemple, pour supprimer le numéro de page avec les chapitres :
\begin{verbatim}
\assignpagestyle{\chapter}{empty}
\end{verbatim}

\subsection{Sauts de page}
%~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{desc}
|\sectionbreak    \subsectionbreak     \subsubsectionbreak|\\
|\paragraphbreak  \subparagraphbreak   \<section>break|
\end{desc}

En définissant ces commandes avec |\newcommand|, différents saut de page peuvent
être appliqués à différents niveaux hiérarchiques. Dans celles non définies, une
pénalité avec une valeur interne fournie par la classe est retenue (typiquement
$-300$). Par exemple,
\begin{verbatim}
\newcommand{\sectionbreak}{\clearpage}
\end{verbatim}
fait que les sections commencent sur une nouvelle page. Dans certaines mises en 
page, l'espace au-dessus du titre est préservé même si la section commence sur
une nouvelle page; ceci est accompli avec:
\begin{verbatim}
\newcommand{\sectionbreak}{%
  \addpenalty{-300}%
  \vspace*{0pt}}
\end{verbatim}

\fbox{2.6} \verb|\<section>break| est également disponible avec la classe 
\verb|top|. Les valeurs admises sont \verb|\cleardoublepage| (valeur par 
défaut avec \verb|openright|) et \verb|\clearpage| (valeur par défaut avec 
\verb|openany|). Ainsi, vous pouvez annuler l'effet de \verb|openright| en définissant 
\verb|\chapterbreak| comme \verb|\clearpage|, du moment que sa 
classe a été changée en \verb|top| (dans cet exemple, les parties conserveront 
le paramétrage \verb|openright|).

\begin{desc}
|\chaptertolists|
\end{desc}

\fbox{2.6} Si cette commande est définie, \trad{l'espace blanc écrit d'habitude 
dans les listes} (que sont la liste des figures et la liste des tables)
est remplacé par le code de cette commande. Si vous ne voulez pas de l'espace
quand un chapitre commence, définissez-le comme vide, autrement dit,
\begin{verbatim}
\newcommand{\chaptertolists}{}
\end{verbatim}

Cette commande n'est pas un outil général pour contrôler l'espacement dans
les listes et n'est valable que dans les titres de classe |top|. Aussi,
elle ne fonctionnera pas avec les chapitres standards sauf si vous changez
leur classe (d'un autre côté, |\...tolists| peut être utilisé dans tout
titre dans la classe est |top|).

\subsection{Autres options de l'extension} \label{others}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{desc}
|explicit| \quad (option d'extension)
\end{desc}

\fbox{2.7} Avec cette option, le titre n'est pas implicite à la fin de |<code-avant>| 
mais doit être indiqué explicitement avec |#1| comme dans, par exemple :
\begin{verbatim} 
\titleformat{\section}
 {..}
 {\thesection}{..}{#1.}
\end{verbatim}
(Comparez ceci avec l'exemple de la section \ref{sec:dotafter}.) 

\begin{desc}
|newparttoc oldparttoc| \quad (options d'extension)
\end{desc}

Les parties standards écrivent leur numéro en table des matières de façon non
standard. Vous pouvez changer cela avec |newparttoc| de façon à ce que  
\textsf{titletoc} ou une extension similaire puisse manipuler cette entrée (ceci 
fonctionne dans le cas où |\part| a été redéfini).

\begin{desc}
|clearempty| \quad (option d'extension)
\end{desc}

Modifie le comportement de |\cleardoublepage| de sorte que le style de page 
|empty| soit utilisé dans les pages vides.

\begin{desc}
|toctitles| \quad (option d'extension)
\end{desc}

\fbox{2.6} Change le comportement de l'argument optionnel dans les 
commandes de sectionnement de telle manière qu'elles fixent uniquement le
titre en en-tête et non l'entrée en table des matières qui sera donc basée sur le titre complet.

\begin{desc}
|newlinetospace| \quad (option d'extension)
\end{desc}

\fbox{2.6} Remplace chaque occurrence de \verb|\\| ou \verb|\\*| dans les
titres par une espace dans les en-têtes et les entrées en table des 
matières. De cette façon, vous n'avez pas à répéter le titre juste pour
retrancher une commande de mise en forme. 

\subsection{Paramétrages étendus} \label{extended}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Le premier argument de |\titleformat| et de |\titlespacing| 
dispose d'une syntaxe étendue qui permet de paramétrer différentes mises en forme
dépendant du contexte\footnote{L'extension \textsf{keyval} est requise pour pouvoir 
utiliser cette syntaxe.}. Cet argument peut être une liste de paires clé/valeur de 
la forme :
\begin{desc}
|<clé>=<valeur>, <clé>=<valeur>, <clé>, <clé>,...|
\end{desc}

Actuellement, seules les pages et les versions non numérotées sont prises en charge, 
\trad{besides} le nom de la commande de sectionnement. Ainsi, les clés disponibles sont :
\begin{itemize}
\item |name|. Les valeurs possibles sont |\chapter|, |\section|, etc.
\item |page|. Les valeurs possibles sont |odd| ou |even|.
\item |numberless|. Une clé sans valeur. Elle ne sert que si vous souhaitez disposer de 
variantes numérotées (sans cette clé) et non numérotées (avec |numberless|).
\end{itemize}
La forme basique décrite ci-dessus avec le nom de la commande de sectionnement, par exemple
\begin{verbatim}
\titleformat{\section} ...
\end{verbatim}
est en fait une abréviation pour
\begin{verbatim}
\titleformat{name=\section} ...
\end{verbatim}
Supposons que nous souhaitons une mise en page avec des titres dans la marge extérieure. 
Nous pourrions définir quelque chose comme 
\begin{verbatim}
\titleformat{name=\section,page=even}[leftmargin]
  {\filleft\scshape}{\thesection}{.5em}{}

\titleformat{name=\section,page=odd}[rightmargin]
  {\filright\scshape}{\thesection}{.5em}{}
\end{verbatim}
Dans la mesure où l'information de page est écrite dans le fichier |aux|, il faut deux 
compilations au minimum pour obtenir le résultat souhaité.


La version numérotée est généralement une base convenable pour parvenir à générer la 
version non numérotée car la suppression de la numérotation est le seul changement 
requis dans la plupart des cas. Mais, si vous avez besoin de mises en forme spéciales, 
la clé |numberless| existe et définit une version alternative des sections sans numéros 
(autrement dit celles avec un niveau sous |secnumdepth|, dans les parties préliminaires et 
annexes du document\footnote{respectivement obtenue avec |\cs{frontmatter}| et |\cs{backmatter}|.}
et, bien entendu, la version étoilée). Par exemple
\begin{verbatim}
\titleformat{name=\section}{...% La définition normale suit
\titleformat{name=\section,numberless}{...% La définition 
% non numérotée suit
\end{verbatim}
|<label>| et |<sep>| ne sont pas ignorés dans les variantes avec |numberless|.

Ces clés sont disponibles à la fois pour |\titleformat| et |\titlespacing|. 
En utilisant |page| dans l'une d'elles (ou les deux), les pages paires et impaires
seront mises en forme différemment. En effet, \og paire \fg{} et \og impaire \fg{}
sont des termes bien établis avec \LaTeX{} mais souvent source de confusion. Dans une 
impression en recto uniquement, les pages \og impaires \fg{} sont également des
pages \og paires \fg{} (cf.\@ |\oddsidemargin|).

Si vous souhaitez créer différentes versions pour les pages paires/impaires \emph{et}
avec ou sans numérotation, il est recommandé de définir quatre variantes.

Si vous retirez la clé |page| d'une commande de sectionnement, vous devez supprimer le
fichier |.aux|.

\subsection{Création de nouveaux niveaux et changement de classe} \label{classes}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Quand les formes et autres modifient le comportement des titres en lien avec le texte
voisin, les classes de titre autorisent le changement de leur comportement générique.
Avec l'aide des classes, vous pouvez insérer, par exemple, un nouveau niveau |subchapter| 
entre |chapter| et |section|, ou créer un nouveau plan de votre cru \emph{Faire un plan
cohérent et définir tous les éléments liés comme les compteurs, les commandes, les 
formats, l'espacement et, s'il y a une table des matières, le format de cette table est
laissé à la responsabilité de l'utilisateur.}. Il existe trois classes : |page| est comme
|\part| (issue de la classe book) sur une page séparée, |top| est comme |chapter| en 
commençant sur une nouvelle page et en plaçant le titre en haut de page, |straight| est
pensé pour les titres en milieu de texte\footnote{Il existe une autre classe nommée
|part| qui sert à émuler le |\cs{part}| de la classe article mais vous ne devriez pas 
l'utiliser du tout. Utiliser la classe |straight| à la place. Rappelez vous que certaines
fonctionnalités reposent sur ces classes et que ne change pas \textsf{titlesec} par défaut 
les définitions de \texttt{\string\part} et \texttt{\string\chapter}.}. 

\begin{desc}
|\titleclass{<nom>}{<classe>}|\\
|\titleclass{<nom>}{<classe>}[<commande-du-niveau-supérieur>]|
\end{desc}

Si vous n'utilisez pas l'argument optionnel, vous changez juste la |<classe>| de
|<nom>|. Par exemple:
\begin{verbatim}
\titleclass{\part}{straight}
\end{verbatim}
attribue la classe |straight| à |part|.

Quand la seconde forme est utilisée, le numéro du niveau est directement sous celui du
|<commande-du-niveau-supérieur>|. Par exemple:
\begin{verbatim}
\titleclass{\subchapter}{straight}[\chapter]
\newcounter{subchapter}
\renewcommand{\thesubchapter}{\Alph{subchapter}}
\end{verbatim}
crée un niveau sous celui du chapitre (du code additionnel est montré ici 
mais vous devez lui ajouter les paramétrages |\titleformat| et |\titlespacing| 
correspondant)\footnote{En ce qui concerne les compteurs, l'extension 
\textsf{remreset} peut être utile.}. 
Si le niveau du chapitre est zéro alors celui du sous-chapitre est 1; les
niveaux en dessous sont incrémenté de 1 (la section devient 2, la sous-section 3
et ainsi de suite).

Il existe deux commandes de sectionnement qui exécutent quelques actions 
supplémentaires selon leur nom et ignorant la classe :
\begin{itemize}
\item |\chapter| enregistre la chaîne définie dans |\chaptertitlename| et la prend
 en compte.
\item |\part| n'encapsule pas la numérotation de l'entrée en table des 
matières sauf si vous utilisez l'option |newparttoc|.
\end{itemize}

\begin{desc}
|loadonly| \quad (option d'extension)
\end{desc}

Supposons que vous voulez créer vos commandes de sectionnement à partir 
de rien. Cette option d'extension ignore tous les définitions antérieures, si elles
existent, et retire ainsi la possibilité d'utiliser les options décrites dans
\og Interface simple \fg{}. Alors, vous pouvez utiliser les outils de 
\textsf{titlesec} et construire les compteurs et numérotations correspondantes.

\begin{desc}
|\titleclass{<nom>}[<numéro-de-niveau-initial>]{<classe>}|
\end{desc}

Ici, le titre |<nom>| est considéré comme le plus haut niveau, avec un
numéro |<numéro-de-niveau-initial>| (typiquement 0 ou $-$1). Cette commande devrait
être maniée uniquement lors de la création de commande de sectionnement à partir de
rien avec l'aide de |loadonly| et il doit y avoir une unique déclaration de ce type.
Après celle-ci, le reste des niveaux est ajouté comme défini ci-dessus.

\section{Notes additionnelles}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Cette partie décrit brièvement quelques commandes \LaTeX{}, utiles lors de la définition
de commandes de sectionnement.

\subsection{Numérotations à largeur fixée}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

La commande |\makebox|  permet d'utiliser une numérotation à largeur fixée, ce qui
fait reposer la marge gauche du titre actuel (pas la numérotation) au même endroit.
Par exemple (seul le code important est indiqué) :
\begin{verbatim}
\titleformat{\section}
  {..}
  {\makebox[2em]{\thesection}}{..}{..}
\end{verbatim}

Voir votre manuel \LaTeX{} pour plus d'information sur les commandes portant sur les boîtes.

\subsection{Versions étoilées} \label{s:starred}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Recourir à la version étoilée dans les commandes de sectionnement est fortement
découragé. En lieu et place, vous pouvez utiliser un ensemble de commandes \trad{markup
oriented} qui sont facile à définir et modifier si nécessaire. Ainsi, vous pouvez tester
différentes mises en page avant de choisir l'une d'entre elles.

Tout d'abord, rappelez-vous que si vous écrivez
\begin{verbatim}
\setcounter{secnumdepth}{0}
\end{verbatim}
les sections ne seront pas numérotées mais seront inclues dans la table des matières
et les en-têtes.

Maintenant, supposons que vous voulez des sections avec un contenu spécial; par exemple,
une section (ou plus) avec des exercices. Nous utiliserons un environnement nommé
|exercices| tel que : 
\begin{verbatim}
\section{A section}
Texte d'une section normale.

\begin{exercices}
\section{Exercices A}
Des exercices

\section{Exercices B}
Des exercices
\end{exercices}
\end{verbatim}

La définition suivante supprime les nombres mais pas les entrées en table des 
matières et pas les impacts sur l'en-tête.
\begin{verbatim}
\newenvironment{exercices}
  {\setcounter{secnumdepth}{0}}
  {\setcounter{secnumdepth}{2}}
\end{verbatim}

La suivante ajoute une entrée en table des matières mais ne modifie pas l'en-tête.
\begin{verbatim}
\newenvironment{exercices}
 {\setcounter{secnumdepth}{0}%
  \renewcommand\sectionmark[1]{}}
 {\setcounter{secnumdepth}{2}}
\end{verbatim}

La suivante met à jour l'en-tête mais ne crée pas d'entrée en table des matières.
\begin{verbatim}
\newenvironment{exercices}
 {\setcounter{secnumdepth}{0}%
  \addtocontents{toc}{\protect\setcounter{tocdepth}{0}\ignorespaces}}
 {\setcounter{secnumdepth}{2}%
  \addtocontents{toc}{\protect\setcounter{tocdepth}{2}\ignorespaces}}
\end{verbatim}
(Je trouve ce dernier cas un peu étrange dans notre exemple; le premier et le deuxième 
cas ont bien plus de sens. Par ailleurs, les |\ignorespaces| ne sont pas très importants et 
ils ne sont nécessaires que si vous avez des espaces non souhaités dans la table des 
matières.) 

Ceci fonctionne avec les classes standards mais, si vous utilisez \textsf{fancyhdr} ou
\textsf{titlesec} pour définir les en-têtes, il faudra avoir recours à des mécaniques 
plus avancées pour supprimer les numéros de section. Dans \textsf{titlesec}, ceci 
s'obtient avec |\ifthesection| (voir ci-dessous).

Comme vous pouvez le voir, il n'y a pas de |\addcontentsline|, de |\markboth| ou de 
|\section*|, juste de la structure logique. Bien entendu, vous pouvez changer ce point
à merci; par exemple, si vous décidez que ces sections doivent être composées en
petits caractères (avec |\small|) et que vous réalisez que vous n'aimez pas cela, 
retirez-le.

Tandis que les commandes d'un \LaTeX{} standard sont plus faciles et directes 
pour les cas simples, je pense que la méthode proposée ci-dessus est de loin préférable
pour les longs documents.


\subsection{Variantes}
%~~~~~~~~~~~~~~~~~~~~~

Supposons que vous souhaitez marquer des sections comme \og sujet avancé \fg{}
par une astérisque après la numérotation. 
Le code suivant effectue cette mise en forme :
\begin{verbatim}
\newcommand{\secmark}{}
\newenvironment{avance}
  {\renewcommand{\secmark}{*}}
  {}
\titleformat{\section}
  {..}
  {\thesection\secmark\quad}{..}{..}
\end{verbatim}

Pour marquer une section, écrivez :
\begin{verbatim}
\begin{avance}
\section{...}
...
\end{avance}
\end{verbatim}

Ceci marque les sections mais pas les sous-sections. Si vous souhaitez un peu de
redondance en marquant les sous-sections également, vous devez les définir de
façon similaire.

\subsection{Placement d'un point après un titre de section} \label{sec:dotafter}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

De nos jours, ce style n'est plus en usage mais il était relativement courant
auparavant. 
La technique de base a été décrite ci-dessus mais en voici un rappel :
\begin{verbatim}
\newcommand{\periodafter}[1]{#1.}
\titleformat{\section}
 {..}
 {\thesection}{..}{..\periodafter}
\end{verbatim}

Si vous avez à combiner ce point avec une commande (tel un soulignement), vous pouvez
saisir :
\begin{verbatim}
\newcommand{\periodafter}[2]{#1{#2.}}
\titleformat{\section}
 {..}
 {\thesection}{..}{..\periodafter{\ul}} % \ul de l'extension soul
\end{verbatim}

Cependant, vous pourriez préférer ici l'option d'extension \texttt{explicit}.

\section{L'extension \textsf{titleps} et le style de page}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

L'extension \textsf{titleps} fournit des outils pour configurer en une 
étape les styles de pages (en-têtes et pieds de page). Une interface de plus haut
niveau est ici utilisée : la mécanique des marques est cachée et il n'y a
pas besoin de gérer les commandes |\leftmark| et |\rightmark|. Il suffit d'utiliser
une commande ou une variable déclarée comme une \og marque \fg{} pour que la valeur
voulue soit restituée, autrement dit, celles utilisées lors la marque est émise (soit 
par une commande de sectionnement soit explicitement par |\chaptermark|, 
|\sectionmark|, etc). Un simple exemple, dont le sens devrait être évident, est ainsi :
\begin{verbatim}
\newpagestyle{main}{
  \sethead[\thepage][\chaptertitle][(\thesection] % paire
          {\thesection)}{\sectiontitle}{\thepage}} % impaire
\pagestyle{main}
\end{verbatim}

Les autres fonctionnalités sont :
\begin{itemize}
\item des marques de début de page (\emph{top mark}) compatibles avec les flottants 
(contrairement au |\topmark| standard, qui ne fonctionne pas correctement dans \LaTeX{}) ;
\item l'accès aux marques de début de page ou de fin de page (\emph{bottom mark}) ainsi 
qu'à la première marque (\emph{first mark}) dans un unique en-tête ou pied de page (par 
exemple les numéros des premières et dernières sections) ;
\item des marques pour plus de deux niveaux de sectionnement ;
\item des filets d'en-tête et de pied de page simples (ou bien moins simples) ;
\item des lignes d'en-tête et de pied de page pour les pages avec des flottants ;
\item des lignes d'en-tête et de pied de page des flottants spécifiques (une sorte 
de |\thispagestyle| pour flottants) ;
\item de multiples ensembles de marques (désignés sous les termes \emph{lots de marques
} et \textit{marques supplémentaires}).
\end{itemize}

L'extension peut être utilisée sans \textsf{titlesec} mais vous en tirerez le meilleur
en usage combiné. Pour la charger seule, saisissez le traditionnel 
\verb|\usepackage{titleps}|. Pour la charger avec \textsf{titlesec}, passez par :
\begin{verbatim}
\usepackage[pagestyles]{titlesec}
\end{verbatim}

Vous pouvez lire |titleps.pdf| (ou éditer |titleps.tex|) pour toute information
complémentaire.

\section{L'extension \textsf{titletoc} et la table des matières}
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Cette extension accompagne l'extension \textsf{titlesec} et gère les entrées en
table des matières. Cependant elle constitue une extension indépendante et peut
être utilisée seule. Sa philosophie est similaire à celle de \textsf{titlesec}---
au lieu de manipuler les commandes définies par la version standard et ses classes,
elle propose de nouvelles commandes avec lesquelles vous pouvez établir le format
des entrées de table de façon générique. Ceci implique que vous avez juste à 
apprendre deux nouvelles commandes basiques et deux outils, ni plus ni moins, et
vous avez alors accès à de nouvelles fonctionnalités. La mise en forme des
paragraphes et les fontes associées sont traitées avec des commandes comme
|\\|, |\makebox|, |\large|, |\itshape| et ainsi de suite. Les entrées en elles-mêmes
ne sont pas mises en forme de quelque manière que ce soit car elles sont souvent
de forme libre.

Le comportement des entrées définies avec \textsf{titletoc} est différent à
certains points de celui de celles créées avec les commandes standards. En 
particulier :
\begin{itemize}
\item les pages ne sont jamais coupées entre entrées si la première est d'un rang 
plus élevé sur la seconde, par exemple entre une section et une sous-section. Si
les deux entrées sont de même niveau, la coupure est autorisée. Enfin, si la 
première entrée est d'un niveau inférieur à la seconde, la possible coupure est 
alors considérée comme pertinente ;
\item Les symboles remplaçant les points dans des points de conduite ne sont pas 
centrés mais alignés à droite. Ceci est généralement plus pratique. 
\end{itemize}

Je souhaite ici souligner qu'aucun essai pour manipuler les tables des matières
ne peut être complet car les commandes standards de \LaTeX{} écrivent directement
des commandes de mises en forme qui ne peuvent être retranchées. C'est tout 
particulièrement le cas pour les listes de figures et de tables et pour la
commande |\part|\footnote{Mais certains de ces problèmes sont résolus par 
\textsf{titlesec}.}

\subsection{Visite guidée de \textsf{titletoc} en 10 minutes}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Les entrées de table de matière sont traitées comme des zones rectangulaires où
le texte et un probable élément de remplissage seront composés. Dessinons une
telle zone (les lignes ne seront pas ici affichées) :
\setlength{\unitlength}{1cm}
\begin{center}
\begin{picture}(8,2.2)
\put(1,1){\line(1,0){6}}
\put(1,2){\line(1,0){6}}
\put(1,1){\line(0,1){1}}
\put(7,1){\line(0,1){1}}
\put(0,.7){\vector(1,0){1}}
\put(8,.7){\vector(-1,0){1}}
\put(0,.2){\makebox(1,.5)[b]{\textit{gauche}}}
\put(7,.2){\makebox(1,.5)[b]{\textit{droite}}}
\end{picture}
\end{center}

L'espace entre la marge gauche de la page et le bord gauche de notre zone
sera nommé |<gauche>|; de manière similaire se définit |<droite>|. Vous êtes
autorisé à modifier le début de la première ligne et la fin de la dernière
ligne. Par exemple, en augmentant leur taille avec |\hspace*{0.5cm}|, cette 
zone devient :
\begin{center}
\begin{picture}(8,2.2)
\put(1,1){\line(1,0){5.5}}
\put(6.5,1){\line(0,1){.5}}
\put(6.5,1.5){\line(1,0){.5}}
\put(1.5,2){\line(1,0){5.5}}
\put(1,1.5){\line(1,0){.5}}
\put(1.5,1.5){\line(0,1){.5}}
\put(1,1){\line(0,1){.5}}
\put(7,1.5){\line(0,1){.5}}
\put(0,.7){\vector(1,0){1}}
\put(8,.7){\vector(-1,0){1}}
\put(0,.2){\makebox(1,.5)[b]{\textit{gauche}}}
\put(7,.2){\makebox(1,.5)[b]{\textit{droite}}}
\end{picture}
\end{center}
Et en retranchant de l'espace à ces deux endroits avec |\hspace*{-0.5cm}|,
la zone ressemble alors à ceci :
\begin{center}
\begin{picture}(8,2.2)
\put(1,1){\line(1,0){6.5}}
\put(7.5,1){\line(0,1){.5}}
\put(7.5,1.5){\line(-1,0){.5}}
\put(.5,2){\line(1,0){6.5}}
\put(1,1.5){\line(-1,0){.5}}
\put(.5,1.5){\line(0,1){.5}}
\put(1,1){\line(0,1){.5}}
\put(7,1.5){\line(0,1){.5}}
\put(0,.7){\vector(1,0){1}}
\put(8,.7){\vector(-1,0){1}}
\put(0,.2){\makebox(1,.5)[b]{\textit{gauche}}}
\put(7,.2){\makebox(1,.5)[b]{\textit{droite}}}
\end{picture}
\end{center}

Si vous avez déjà vu des tables de matières, ce qui suit devrait vous être
familier --- la numérotation en tout début et le numéro de page tout à la
fin :
\begin{verbatim}
    3.2  Ceci est un exemple montant une entrée de table des matières
         respectant ce principe . . . . . . . . . . . . . . . . . . .   4
\end{verbatim}

Tout ce dont vous avez besoin est de mettre ces éléments dans les bonnes 
positions. Si vous avez réservé l'espace avec |\hspace*{-0.5cm}|, mettez 
simplement une boîte de 0,5 cm de large contenant la numérotation ou le numéro
de page pour que cet espace soit récupéré ; cette présentation est si 
courante que deux commandes sont données pour la générer pour vous : 
\begin{itemize}
\item |\contentslabel{<longueur>}| crée l'espace au début et y place la
numérotation ;
\item |\contentspage| crée l'espace à la fin de largeur  |<droite>| et y 
écrit le numéro de page aligné à droite.
\end{itemize}

Maintenant, nous allons voir trois commandes basiques :

\begin{desc}
|\dottedcontents{<section>}[<gauche>]{<code-dessus>}|\\
|                {<largeur-num>}{<largeur-motif>}|
\end{desc}

Ici:
\begin{itemize}
\item |<section>| est le nom de la \trad{section} sans l'antislash : |part|,
  |chapter|, |section|, etc. |figure| et |table| sont autorisés également
  (l'antislash est omis car nous nous occupons du concept et non des
  commandes de sectionnement elles-mêmes. Par ailleurs, |figure| et |table| 
  sont des environnements).

\item |<code-dessus>| est le code mettant en forme globalement l'entrée.
  Des éléments verticaux sont autorisés. À ce niveau, la valeur de 
  |\thecontentslabel| (voir ci-dessous) est connue, ce qui permet de prendre
  des décisions basées sur sa valeur (avec l'aide de l'extension 
  \textsf{ifthen}). Vous pouvez utiliser les commandes de \textsf{titlesec}
  |\filleft|, |\filright|, |\filcenter| et |\fillast|. 

\item |<gauche>|, même s'il est mis entre crochet, est actuellement obligatoire
  et fixe l'espacement à gauche à partir de la marge gauche de la page.
  
\item |<largeur-num>| est la largeur de l'espace créé pour la numérotation 
  comme décrit ci-dessus.
  
\item |<largeur-motif>| est la largeur de la boîte contenant le caractère
  qui va servir de motif au remplissage de la ligne, comme décrit ci-dessous.
\end{itemize}

Les définitions des entrées pour les sections et sous-sections dans la classe 
\textsf{book} sont à peu près équivalentes à :
\begin{verbatim}
\contentsmargin{2.55em}
\dottedcontents{section}[3.8em]{}{2.3em}{1pc}
\dottedcontents{subsection}[6.1em]{}{3.2em}{1pc}
\end{verbatim}

\begin{desc}
|\titlecontents{<section>}[<gauche>]{<code-dessus>}|\\
|              {<format-entrée-numérotée>}{<format-entrée-non-numérotée>}|\\
|              {<format-remplissage-page>}[<code-dessous>]|
\end{desc}

Ici |<section>|, |<gauche>| and |<code-dessus>| fonctionnent comme ci-dessus et
\begin{itemize}
\item |<format-entrée-numérotée>| est en mode horizontal et va être utilisée
  juste avant le titre de l'entrée. Comme dans |\titleformat|, la dernière 
  commande ici peut prendre comme argument le titre ;

\item |<format-entrée-non-numérotée>| est comme le précédent argument... en 
  l'absence de numérotation ;

\item|<format-remplissage-page>| se comprend d'elle-même. Les éléments de remplissage
  sont créés avec la commande |\titlerule| qui est partagée entre cette extension et
  \textsf{titlesec}. Cependant, utilisée dans ce contexte, son comportement change 
  quelque peu pour convenir aux besoins des points de conduite de la table des 
  matières\footnote{Pour les \TeX{}niciens, |\cs{xleaders}| devient ici 
  |\cs{leaders}|.}. Vous pourriez préférer un |\hspace| à la place.

\item et, enfin, |<code-dessous>| est le code suivant l'entrée pour, par exemple,
  un espace vertical.
\end{itemize}

Lors de la définition des entrées, utilisez |\addvspace| si vous voulez ajouter un
espace vertical et |\\*| au lieu de  |\\| pour des retours à la ligne.

Cette commande peut être utilisée en cours de document pour changer le format des
entrées des tables des matières, listes des tables et des listes à n'importe quel
moment. Le nouveau format est écrit dans le fichier toc et nécessite donc deux 
compilations pour être observable.

\begin{desc}
|\contentsmargin{<droite>}|
\end{desc}

La valeur fixée est utilisée dans toutes les sections. Si vous vous demandez
pourquoi, la réponse est plutôt simple : dans la plupart des cas, la marge
|<droite>| sera constante. Cependant, vous avez le droit de la changer localement
dans les arguments |<code-avant>|. Notez d'ailleurs que l'espace par défaut des
classes standards ne laisse pas de place pour afficher des numéros de page 
dépassant 100 en gras et vous pourriez avoir besoin de fixer une largeur de marge
plus importante avec cette commande.

La mise en forme des entrées de section de la classe \textsf{book} est similaire
(mais pas égale) à :
\begin{verbatim}
\titlecontents{section}
              [3.8em] % autrement dit, 1.5em (chapitre) + 2.3em 
              {}
              {\contentslabel{2.3em}}
              {\hspace*{-2.3em}}
              {\titlerule*[1pc]{.}\contentspage}
\end{verbatim}
Comparez cette définition avec celle donnée plus haut et vous comprendrez
comment |\dottedcontents| est défini.

Bien les classes standards se servent d'unités dépendant de la taille des 
caractères (principalement l'em), il est recommandé de se servir d'unités
absolues (cm, pt, etc.) pour garantir le bon alignement des entrées.

\subsection{Et bien plus}
%~~~~~~~~~~~~~~~~~~~~~~~~

Des règles typographiques strictes indiquent que les lignes de texte pleines
ne peuvent aller plus loin que le dernier point d'un ensemble de points de 
conduite ; idéalement, elles devraient être alignées avec ce point. De façon
assez étonnante, \TeX{} ne dispose pas d'un outil pour faire ceci 
automatiquement --- lorsque vous remplissez une boîte de points de conduite,
ils peuvent être centrés dans la boîte avec |\cleaders|, justifiés avec 
|\xleaders| ou alignés avec le bord extérieur de la boîte qui les contient 
avec |\leaders| mais il n'y a pas de façon de les aligner avec la marge
\og courante \fg{}.

Aussi, la seule façon d'obtenir un bon rendu est de le faire à la main. 
Pour cela, vous pouvez utiliser l'argument optionnel dans la commande
|\contentsmargin| dans la syntaxe complète est la suivante :
\begin{desc}
|\contentsmargin[<correction>]{<droite>}|
\end{desc}

La longueur de |<correction>| est ajoutée à celle de |<right>| dans toutes les
lignes sauf la dernière, où les points de conduite sont placés. Par exemple, si 
les lignes de texte font 6 pt de plus que celles du dernier point, vous devriez
la commande |\contentsmargin| pour y ajouter une |<correction>| de 6 
pt\footnote{Pour vous aider, de nombreux \trad{prévisualisateurs} de dvi permettent 
d'obtenir les coordonnées de la localisation pointée.}. Contrairement aux 
outils \LaTeX{} standards, la commande |\titlerule*| a été développée pour
que la |<correction>| ait la valeur la plus petite possible.

\begin{desc}
|\thecontentslabel  \thecontentspage|
\end{desc}

Ces commandes contiennent le texte de la numérotation et de la page sans autre
mise en forme que celle générée par la classe.

\begin{desc}
|\contentslabel[<format>]{<espace>}|\\
|\contentspage[<format>]|
\end{desc}

Comme décrit plus haut, mais avec différents types de |<format>|. Les valeurs par
défaut sont juste |\thecontentslabel| et |\thecontentspage|, respectivement.

\begin{desc}
|\contentspush{<texte>}|
\end{desc}

Affiche le |<texte>| et augmente |<gauche>| de la largeur du |<texte>|. Ceci 
est similaire à la forme |hang| de \textsf{titlesec}.

\begin{desc}
|\titlecontents*{<section>}[<gauche>]{<code-dessus>}|\\
|               {<format-entrée-numérotée>}{<format-entrée-non-numérotée>}|\\
|               {<format-remplissage-page>}[<séparateur>]|\\[3pt]
|            |\textit{ou ...}|{<format-remplissage-page>}[<séparateur>][<fin>]|\\
|            |\textit{ou ...}|{<format-remplissage-page>}[<début>][<séparateur>][<fin>]|
\end{desc}

Cette version étoilée regroupe les entrées dans un unique paragraphe. 
L'argument |<séparateur>| est le séparateur entre les entrées et il y
a un argument optionnel pour une ponctuation finale. Par exemple, ce
document demande :
\begin{verbatim}
\titlecontents*{subsection}[1.5em]
  {\small}
  {\thecontentslabel. }
  {}
  {, \thecontentspage}
  [.---][.]
\end{verbatim}
dont le résultat est affiché dans la table des matières en tout début de ce document. 
Notez que la mise en forme du paragraphe doit être écrite dans l'argument 
|<code-dessus>|.

Expliquons comment fonctionnent les arguments optionnels. Notez d'une part que leur 
nombre détermine leur sens --- comme il doit y avoir un séparateur entre les entrées,
celui est toujours présent; d'autre part, |<début>| est rarement utilisé et est
défavorisé en n'apparaissant que dans la version ayant le plus d'argument. Le cas 
le plus simple est celui où les titres ont le même niveau; dans ce cas, les
paramètres |<séparateur>| et |<fin>| (dont les valeurs par défaut sont des vides) 
sont respectivement insérés entre des entrées consécutives et à la fin du bloc. 
|<code-avant>| est exécuté une seule fois au tout début du bloc et ses déclarations
sont locales à l'ensemble des entrées.

Maintenant supposons que nous souhaitons grouper les entrées de deux niveaux ;
dans ce cas un principe d'imbrication s'applique. Pour détailler ce point, nous
illustrerons avec une section et une sous-section. Quand une entrée de sous-section
commence après une section, |<code-avant>| est exécuté et |<début>| (de
sous-section) est inséré, qui contient de la mise en forme de texte uniquement. Les
sous-sections sont ajoutées en insérant des séparateurs comme expliqué ci-dessus.
Quand une section arrive, la ponctuation finale de la sous-section et le séparateur
de la section sont ajoutés (à moins que le bloc ne s'achève par une sous-section, 
auquel cas seule la fin de la section est ajoutée). Nous avons \og après une 
section \fg{} car une sous-section ne commence jamais un bloc\footnote{Dans de 
rares cas, cela pourrait être nécessaire, cependant.}. Les entrées de sous-section
sont regroupées au sein de chaque entrée de section et les déclarations sont 
à nouveau locales.

Un exemple va illustrer ceci :
\begin{verbatim}
\titlecontents*{section}[0pt]
  {\small\itshape}{}{}
  {}[ \textbullet\ ][.]

\titlecontents*{subsection}[0pt]
  {\upshape}{}{}
  {, \thecontentspage}[ (][. ][)]
\end{verbatim}
Ce code produit quelque chose similaire à :
$$\begin{minipage}{\textwidth}
\small\itshape La première section \textbullet\ La deuxième  \textbullet\ 
La troisième {\upshape(Une sous-section, 1. Une autre, 2)} \textbullet\ La 
quatrième {\upshape(Une sous-section, 1. Une autre, 2)}.
\end{minipage}$$

\begin{desc}
|\contentsuse{<nom>}{<extension>}|
\end{desc}

Cette commande rend \textsf{titletoc} sensible à l'existence d'un fichier de
table de matières (ou d'un fichier de liste) avec l'extension |<extension>|. 
Elle a pour rôle principal de s'assurer que la commande |\contentsfinish| 
est ajoutée à la fin de la table ou liste ciblée (et qui doit être ajoutée
à la fin des tables des matières faites manuellement).
L'extension exécute 
\begin{verbatim}
\contentsuse{figure}{lof}
\contentsuse{table}{lot}
\end{verbatim}

% \begin{desc}
% |\titlelevels{<haut>}{<niveau-liste>}|
% \end{desc}
% 
% Si vous n'utilisez par \textsf{titlesec}, cette commande modifie
% la liste des noms de niveau. N'est nécessaire que vous avez constitué
% votre propre hiérarchie de titres.

\begin{desc}
|leftlabels  rightlabels| \quad (options d'extension)
\end{desc}

Ces options d'extension définissent l'alignement des numérotations dans
|\contentslabel|.
La valeur par défaut est |rightlabels|. Avec |leftlabels| le |<format>| par
défaut pour |\contentslabel| devient |\thecontenstlabel\enspace|.

\begin{desc}
|dotinlabels| \quad (options d'extension)
\end{desc}

Avec cette option d'extension, un point est ajouté après la numérotation
dans |\contentslabel|.

\subsection{Table des matières partielle}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{desc}
|\startcontents[<nom>]|
\end{desc}

\trad{Bien relire}\`{A} l'endroit où cette commande est utilisée, une table des matières partielle
(notez que le document ne nécessite pas la présence d'un |\tableofcontents| pour
que les tables de matières partielles fonctionnent). L'argument |<nom>| autorise
différents ensembles de table de matières et sa valeur par défaut est |default|.
Ces ensembles peuvent être mélangés mais sont d'habitude séparés. Par exemple,
vous pouvez souhaiter deux types de tables de matières partielles : par partie
et par chapitre (en plus de la table générale complète, bien entendu). Quand 
une partie commence, écrivez |\startcontents[parts]| et, quand un chapitre
commence, |\startcontents[chapters]|. De cette manière, une nouvelle table est
entamée pour chaque partie et chapitre\footnote{\emph{Toutes} les tables partielles
sont stockées dans un unique fichier d'extension |.ptc|.}.

\begin{desc}
|\stopcontents[<nom>]|\\
|\resumecontents[<nom>]|
\end{desc}

La première commande arrête la table partielle de type |<nom>| , qui peut être ensuite
poursuivi avec la seconde. Comme les tables partielles peuvent être interrompues
avec |\startcontents| si nécessaire, ces commandes ne seront pas souvent utilisées.

\begin{desc}
|\printcontents[<nom>]{<préfixe>}{<niveau-début>}{<code-table>}|
\end{desc}

Cette commande affiche la table des matière actuelle de type |<nom>|. Le format 
des entrées de la table principale est utilisé, sauf si il y a un |<préfixe>|.
Dans ce cas, le format de |<préfixe><niveau>| est utilisé s'il existe. Par
exemple, si le préfixe est |l| et que le format |lsection| est défini, alors la
définition sera utilisée; sinon le format est celui de |section|. L'argument
|<niveau-début>| fixe le niveau le plus haut des tables de matières --- pour une
table de matières d'une partie ce devrait être |0| (chapitre), pour une table de
matières d'un chapitre |1| (section) et ainsi de suite. Enfin, |<code-table>| 
est un code local pour la table locale ; il peut être utilisé pour changer la
valeur de |tocdepth| ou |\contentsmargin|, par exemple.

Une utilisation simple pourrait ressembler à ce qui suit (en supposant que vous
utilisez aussi \textsf{titlesec}):
\begin{verbatim}
\titleformat{\chapter}[display]
  {...}{...}{...}  % Vos définitions sont ici
  [\vspace*{4pc}%
   \startcontents
   \printcontents{l}{1}{\setcounter{tocdepth}{2}}]
   
\titlecontents*{lsection}[0pt]
  {\small\itshape}{}{}
  {}[ \textbullet\ ][.]
\end{verbatim}
Les entrées ici traitées sont celles de niveau 1 et 2.

\subsection[Liste partielle]{Liste partielle \normalfont\normalsize\fbox{2.6}}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Vous pouvez créer des tables partielles de figures et de tables. La syntaxe est
ici similaire à celle des tables des matières et ce qui a été dit à leur propos
peut être appliqué également ici. Les commandes sont :
\begin{desc}
|\startlist[<nom>]{<liste>}|\\
|\stoplist[<nom>]{<liste>}|\\
|\resumelist[<nom>]{<liste>}|\\
|\printlist[<nom>]{<liste>}{<préfixe>}{<code-table>}|
\end{desc}

Ici, la |<liste>| est soit |lof| pour les figures, soit |lot| pour les tables.
Notez également que |\printlist| n'a pas d'argument |<début-niveau>| parce que
les tables de figures et de tables n'ont pas de niveau. Actuellement, seules
ces deux types de tables sont gérés mais dans une prochaine version le support
d'autres tables sera ajouté. Malheureusement, de nombreuses classes placent
des commandes de mise en forme dans ces listes (plus exactement, 
\verb|\addvspace| dans les chapitres); je ne suis pas sûr de savoir comment
retrancher ces commandes sans en retirer d'autres qui peuvent être souhaitées. 
En attendant, une astuce revient à retirer ces espaces en redéfinissant
\verb|\addvspace| dans |<code-table>| avec |\renewcommand\addvspace[1]{}|.

\subsection{Exemples}
%~~~~~~~~~~~~~~~~~~~~

\begin{verbatim}
\titlecontents{chapter}
              [0pt]
              {\addvspace{1pc}%
               \itshape}%
              {\contentsmargin{0pt}%
               \bfseries
               \makebox[0pt][r]{\huge\thecontentslabel\enspace}%
               \large}
              {\contentsmargin{0pt}%
               \large}
              {\quad\thepage}
              [\addvspace{.5pc}]
\end{verbatim}

\trad{Vérifier} Le numéro de chapitre est placé au bord de la marge de la
page, dans une fonte plus grande que celle du titre. Si le chapitre n'a
pas de numérotation (parce qu'il s'agit, par exemple, d'une préface ou
d'une bibliographie), il n'est pas mis en gras.  Le numéro de page suit
le titre sans motif de remplissage mais avec un espace d'un em.

\begin{verbatim}
\titlecontents{chapter}
              [3pc]
              {\addvspace{1.5pc}%
               \filcenter}
              {CHAPTER \thecontentslabel\\*[.2pc]%
               \huge}
              {\huge}
              {}  % Autrement dit, sans numéro de page.
              [\addvspace{.5pc}]
\end{verbatim}
              
Le titre du chapitre est centré avec la numérotation de chapitre 
\trad{au-dessus}. Il n'y a pas de numéro de page.

\subsection{Insertion d'une figure en table des matières}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

La commande |\addtocontents| est toujours disponible et vous pouvez l'utiliser
pour exécuter des opérations particulières, comme insérer une figure juste
avant ou après une entrée. Hélas, les arguments fragiles ne sont pas autorisés
et écrire un code complexe peut devenir un enfer. L'astuce est de définir 
une commande qui effectue les opérations souhaitées et en la faisant précéder
de la commande |\protect|.

Supposons que nous voulons insérer une figure avant une entrée.
\begin{verbatim}
\newcommand{\figureintoc}[1]{
  \begin{figure}
    \includegraphics{#1}%
  \end{figure}}
\end{verbatim}
contribue à rendre le travail peu satisfaisant. En lieu et place, préférez
la syntaxe suivante :
\begin{verbatim}
\addtocontents{\protect\figureintoc{myfig}}
\end{verbatim}


\subsection{Repérage d'entrées avec des astérisques}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Retrouvons maintenant un problème expliqué en relation avec \textsf{titlesec} : 
placer une astérisque sur les sections abordant un \og sujet complexe \fg{} auquel
nous ajoutons le besoin de faire figurer l'astérisque dans la table des matières. 
Voici le code :
\begin{verbatim}
\newcommand{\secmark}{}
\newcommand{\marktotoc}[1]{\renewcommand{\secmark}{#1}}
\newenvironment{advanced}
  {\renewcommand{\secmark}{*}%
   \addtocontents{toc}{\protect\marktotoc{*}}}
  {\addtocontents{toc}{\protect\marktotoc{}}}
\titleformat{\section}
  {..}
  {\thesection\secmark}{..}{..}
\titlecontents{section}[..]{..}
  {\contentslabel[\thecontentslabel\secmark]{1.5pc}}{..}{..}
\end{verbatim}

\section{La philosophie de \textsf{titlesec}}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Une fois que vous avez lu cette documentation, il devrait être clair que cette
extension n'est pas destinée à l'utilisateur occasionnel qui aime la présentation
classique et souhaite juste y apporter quelques modifications simples. Il s'agit ici
d'un outil pour le typographe sérieux qui a une idée claire de la présentation 
souhaitée et qui n'avait auparavant pas les moyens pour l'obtenir. Rien n'est fait non
plus pour améliorer votre goût en matière de mise en forme des sectionnements.


\section{Annexes}
%~~~~~~~~~~~~~~~~

Les exemples suivants servent d'illustrations. Dans cette partie, |\parskip| est
fixé à 0 pt.

\begingroup

\addtocontents{toc}{\protect\setcounter{tocdepth}{-1}\ignorespaces}
\setlength{\parskip}{0pt}

\examplesep

\titleformat{\section}[block]
  {\normalfont\bfseries\filcenter}{\fbox{\itshape\thesection}}{1em}{}

\section[Annexes]{Ceci est un exemple de la commande de section définie ci-dessous 
et, je dirais même plus, ceci est un exemple de la commande de section définie 
ci-dessous}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{verbatim}
\titleformat{\section}[block]
  {\normalfont\bfseries\filcenter}{\fbox{\itshape\thesection}}{1em}{}
\end{verbatim}

\examplesep

\titleformat{\section}[frame]
  {\normalfont}
  {\filright
   \footnotesize
   \enspace SECTION \thesection\enspace}
  {8pt}
  {\Large\bfseries\filcenter}

\section[Annexes]{Un titre encadré}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{verbatim}
\titleformat{\section}[frame]
  {\normalfont}
  {\filright
   \footnotesize
   \enspace SECTION \thesection\enspace}
  {8pt}
  {\Large\bfseries\filcenter}
\end{verbatim}

\examplesep

\titleformat{\section}
  {\titlerule
   \vspace{.8ex}%
   \normalfont\itshape}
  {\thesection.}{.5em}{}

\section[Annexes]{Un titre avec filet horizontal}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{verbatim}
\titleformat{\section}
  {\titlerule
   \vspace{.8ex}%
   \normalfont\itshape}
  {\thesection.}{.5em}{}
\end{verbatim}

\examplesep

\titleformat{\section}[block]
  {\normalfont\sffamily}
  {\thesection}{.5em}{\titlerule\\[.8ex]\bfseries}
  
\section[Annexes]{Un autre titre avec filet horizontal}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{verbatim}
\titleformat{\section}[block]
  {\normalfont\sffamily}
  {\thesection}{.5em}{\titlerule\\[.8ex]\bfseries}
\end{verbatim}

\examplesep

\titleformat{\section}[block]
  {\filcenter\large
   \addtolength{\titlewidth}{2pc}%
   \titleline*[c]{\titlerule*[.6pc]{\tiny\textbullet}}%
   \addvspace{6pt}%
   \normalfont\sffamily}
  {\thesection}{1em}{}
\titlespacing{\section}
  {5pc}{*2}{*2}[5pc]

\section[Annexes]{La largeur du filet ci-dessus est celle de la
  plus longue ligne de ce titre augmentée de deux picas}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\leavevmode

\section[Annexes]{Celui-ci est plus court}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{verbatim}
\titleformat{\section}[block]
  {\filcenter\large
   \addtolength{\titlewidth}{2pc}%
   \titleline*[c]{\titlerule*[.6pc]{\tiny\textbullet}}%
   \addvspace{6pt}%
   \normalfont\sffamily}
  {\thesection}{1em}{}
\titlespacing{\section}
  {5pc}{*2}{*2}[5pc]
\end{verbatim}

\examplesep

\titleformat{\section}[display]
  {\normalfont\fillast}
  {\scshape section \oldstylenums{\thesection}}
  {1ex minus .1ex}
  {\small}
\titlespacing{\section}
  {3pc}{*3}{*2}[3pc]

\section[Annexes]{Ceci est un exemple de la commande de section définie ci-dessous 
et, je dirais même plus, ceci est un exemple de la commande de section définie 
ci-dessous. Répétons-le : ceci est un exemple de la commande de section définie 
ci-dessous et, je dirais même plus, ceci est un exemple de la commande de section 
définie ci-dessous}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{verbatim}
\titleformat{\section}[display]
  {\normalfont\fillast}
  {\scshape section \oldstylenums{\thesection}}
  {1ex minus .1ex}
  {\small}
\titlespacing{\section}
  {3pc}{*3}{*2}[3pc]
\end{verbatim}

\examplesep

\titleformat{\section}[runin]
  {\normalfont\scshape}
  {}{0pt}{}
\titlespacing{\section}
  {\parindent}{*2}{\wordsep}
  
\section*{Cette partie est le titre lui-même}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
et cette partie est le corps du texte associé\ldots

\begin{verbatim}
\titleformat{\section}[runin]
  {\normalfont\scshape}
  {}{0pt}{}
\titlespacing{\section}
  {\parindent}{*2}{\wordsep}
\end{verbatim}

\examplesep

\titleformat{\section}[wrap]
  {\normalfont\fontseries{b}\selectfont\filright}
  {\thesection.}{.5em}{}
\titlespacing{\section}
  {12pc}{1.5ex plus .1ex minus .2ex}{1pc}

\section[Annexes]{Un exemple simple d'une forme \og wrap \fg{} sur une section}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Suivi d'un peu de texte pour montrer le résultat. Suivi d'un peu de texte pour 
montrer le résultat. Suivi d'un peu de texte pour montrer le résultat. Suivi d'un 
peu de texte pour montrer le résultat. Suivi d'un peu de texte pour montrer le
résultat. Suivi d'un peu de texte pour montrer le résultat. Suivi d'un peu de 
texte pour montrer le résultat.

\section[Annexes]{Et un autre}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Notez comment le texte enveloppe (en anglais, \og wrap \fg{}) le titre et que
l'espace qui lui est réservé est automatiquement réajustée. Et il est suivi par un 
peu de texte pour illustrer le propos. Et il est suivi par un peu de texte pour
illustrer le propos.

\begin{verbatim}
\titleformat{\section}[wrap]
  {\normalfont\fontseries{b}\selectfont\filright}
  {\thesection.}{.5em}{}
\titlespacing{\section}
  {12pc}{1.5ex plus .1ex minus .2ex}{1pc}
\end{verbatim}

\examplesep

\titleformat{\section}[runin]
  {\normalfont\bfseries}
  {\S\ \thesection.}{.5em}{}[.---]
\titlespacing{\section}
  {\parindent}{1.5ex plus .1ex minus .2ex}{0pt}

\section[Annexes]{Un titre attaché à l'ancienne}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Bien sûr, vous pourriez préférer juste un point après le titre. Dans ce cas, l'argument
optionnel devrait être |[.]| et l'espace attenante devrait avoir une valeur 
assez forte (1em, par exemple).

\begin{verbatim}
\titleformat{\section}[runin]
  {\normalfont\bfseries}
  {\S\ \thesection.}{.5em}{}[.---]
\titlespacing{\section}
  {\parindent}{1.5ex plus .1ex minus .2ex}{0pt}
\end{verbatim}

\examplesep

\titleformat{\section}[leftmargin]
  {\normalfont
   \titlerule*[.6em]{\bfseries .}%
   \vspace{6pt}%
   \sffamily\bfseries\filleft}
  {\thesection}{.5em}{}
\titlespacing{\section}
  {4pc}{1.5pc plus .1ex minus .2ex}{1pc}

\section*{Exemple de section marginale}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Suivi d'un peu de texte pour montrer le résultat. Mais ne vous arrêtez pas de lire car
l'exemple qui suit illustre comment tirer parti d'autres extensions. La dernière 
commande dans le dernier argument peut prendre un argument, à savoir le titre sans 
autre commande additionnelle incluse. Nous donnons ici juste le code mais vous pouvez
l'essayer. Donc, avec l'extension \textsf{soul}, vous pourriez écrire
\begin{verbatim}
\newcommand{\secformat}[1]{\MakeLowercase{\so{#1}}}
   % \so écarte les lettres
\titleformat{\section}[block]
  {\normalfont\scshape\filcenter}
  {\thesection}
  {1em}
  {\secformat}
\end{verbatim}

Le titre marginal ci-dessus a été défini avec le code suivant :
\begin{verbatim}
\titleformat{\section}[leftmargin]
  {\normalfont
   \titlerule*[.6em]{\bfseries.}%
   \vspace{6pt}%
   \sffamily\bfseries\filleft}
  {\thesection}{.5em}{}
\titlespacing{\section}
  {4pc}{1.5ex plus .1ex minus .2ex}{1pc}
\end{verbatim}

\examplesep

Les exemples suivants sont pensés pour des chapitres. Cependant, cette documentation 
ne dispose par de la commande |\chapter| et illustre ce point en utilisant |\section|
avec quelques rares changements.  

\titlespacing{\section}{0pt}{*4}{*4}
\titleformat{\section}[display]
  {\normalfont\Large\filcenter\sffamily}
  {\titlerule[1pt]%
   \vspace{1pt}%
   \titlerule
   \vspace{1pc}%
   \LARGE\MakeUppercase{chapter} \thesection}
  {1pc}
  {\titlerule
   \vspace{1pc}%
   \Huge}

\section[Annexes]{Le titre}
%~~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{verbatim}
\titleformat{\chapter}[display]
  {\normalfont\Large\filcenter\sffamily}
  {\titlerule[1pt]%
   \vspace{1pt}%
   \titlerule
   \vspace{1pc}%
   \LARGE\MakeUppercase{\chaptertitlename} \thechapter}
  {1pc}
  {\titlerule
   \vspace{1pc}%
   \Huge}
\end{verbatim}
   
\examplesep

\def\thesection{\Roman{section}}
\titleformat{\section}[display]
  {\bfseries\Large}
  {\filleft\MakeUppercase{chapter} \Huge\thesection}
  {4ex}
  {\titlerule
   \vspace{2ex}%
   \filright}
  [\vspace{2ex}%
   \titlerule]

\section[Annexes]{Le titre}
%~~~~~~~~~~~~~~~~~~~~~~~~~~

\begin{verbatim}
\renewcommand{\thechapter}{\Roman{chapter}}
\titleformat{\chapter}[display]
  {\bfseries\Large}
  {\filleft\MakeUppercase{\chaptertitlename} \Huge\thechapter}
  {4ex}
  {\titlerule
   \vspace{2ex}%
   \filright}
  [\vspace{2ex}%
   \titlerule]
\end{verbatim}

\addtocontents{toc}{\protect\setcounter{tocdepth}{2}\ignorespaces}
\setcounter{section}{9}
\endgroup

\bigskip 

\subsection{Un exemple complet}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Voici maintenant un exemple complet d'une structure de titres.

\begin{verbatim}
\documentclass[twoside]{report}
\usepackage[sf,sl,outermarks]{titlesec}

% \chapter, \subsection...: pas de code additionnel

\titleformat{\section}
  {\LARGE\sffamily\slshape}
  {\thesection}{1em}{}
\titlespacing{\section}
  {-6pc}{3.5ex plus .1ex minus .2ex}{1.5ex minus .1ex}

\titleformat{\paragraph}[leftmargin]
  {\sffamily\slshape\filright}
  {}{}{}
\titlespacing{\paragraph}
  {5pc}{1.5ex minus .1 ex}{1pc}

% 5+1=6, autrement dit, la marge négative de gauche dans 
% la section

\widenhead{6pc}{0pc}
  
\renewpagestyle{plain}{}

\newpagestyle{special}[\small\sffamily]{
   \headrule
   \sethead[\usepage][\textsl{\chaptertitle}][]
           {}{\textsl{\chaptertitle}}{\usepage}}
               
\newpagestyle{main}[\small\sffamily]{
   \headrule
   \sethead[\usepage][\textsl{\thechapter. \chaptertitle}][]
           {}{\textsl{\thesection. \sectiontitle}}{\usepage}}

\pagestyle{special}

\begin{document}

---Table des matières

\pagestyle{main}

---Corps du document

\pagestyle{special}

---Index
\end{document}
\end{verbatim}

\subsection{Classes standards}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Voici, pour votre information, comment peuvent être définies les commandes des classes
standards.
\begin{verbatim}
\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries}{\chaptertitlename\ \thechapter}{20pt}{\Huge}
\titleformat{\section}
  {\normalfont\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}
  {\normalfont\large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}
  {\normalfont\normalsize\bfseries}{\thesubsubsection}{1em}{}
\titleformat{\paragraph}[runin]
  {\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titleformat{\subparagraph}[runin]
  {\normalfont\normalsize\bfseries}{\thesubparagraph}{1em}{}

\titlespacing*{\chapter}      {0pt}{50pt}{40pt}
\titlespacing*{\section}      {0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{\subsection}   {0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing*{\paragraph}    {0pt}{3.25ex plus 1ex minus .2ex}{1em}
\titlespacing*{\subparagraph} {\parindent}{3.25ex plus 1ex minus .2ex}{1em}
\end{verbatim}

\subsection{Exemple de chapitre}
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Un dernier exemple montre comment tirer parti de l'environnement |picture| pour
des formats de sectionnement moins courants. Même avec les outils simples fournis
par la version standard de \LaTeX{}, vous pouvez créer des titres marquants. Mais
vous pouvez en faire d'encore plus élaborés avec, par exemple, |pspicture| 
(de l'extension \textsf{PSTricks}) ou en incorporant des graphiques créés avec
l'aide de programmes externes.

\begin{verbatim}
\usepackage[dvips]{color}
\usepackage[rigidchapters,explicit]{titlesec}
    
\DeclareFixedFont{\chapterfont}{T1}{phv}{bx}{n}{11cm}

\titlespacing{\chapter}{0pt}{0pt}{210pt}
% La plupart des titres ont un peu de profondeur. L'espace total
% est un peu plus large que la boîte contenant l'image.

\titleformat{\chapter}[block]
  {\begin{picture}(330,200)}
  {\put(450,80){%
     \makebox(0,0)[rb]{%
       \chapterfont\textcolor[named]{SkyBlue}{\thechapter}}}
   \put(0,230){%
     \makebox(0,0)[lb]{%
       \Huge\sffamily\underline{Chapitre \thechapter}}}}
  {0pt}
  {\put(0,190){\parbox[t]{300pt}{%
     \Huge\sffamily\filright#1}}}
  [\end{picture}]
\end{verbatim}

(Les valeurs exactes à utiliser dépendent de la zone de texte, de la classe,
de |\unitlength|, du format du papier, etc.)

\end{document}
